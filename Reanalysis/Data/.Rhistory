# Packages to call from library when opening R:
# (to add new ones to this list)
library(tidyverse)
library(dplyr)
library(vegan)
library(ggplot2)
library(cowplot)
library(RColorBrewer)
library(car)
library(reshape2)
library(scales)
library(ARTool)
library(tidyr)
library(emmeans)
library(multcomp)
library(viridis)
library(rcompanion)
library(psych)
library(devtools)
library(pairwiseAdonis)
# Loading data
setwd("/Users/talimass/Documents/Documents - MacBook Pro/GitHub/Coral-communities-along-the-depth-gradient-in-the-Red-Sea-reefs-of-Eilat/Reanalysis/Data")
lc_sf.data<-read.csv('Annotations_MO_25062024_ver1.csv',header=TRUE, stringsAsFactors = TRUE)
str(lc_sf.data)
levels(lc_sf.data$GROUP)
################ calculate proportion of live:
# to summarize how many live  and how many Non_live we have per picture:
live=aggregate(Count~SITE+DEPTH+PIC+Live_Non_live, data=lc_sf.data, FUN="sum")
# to keep only live data:
live=live[live$Live_Non_live=="Live",]
# to calculate the proportion:
live$prop=live$Count/64
# add variable that gives % coverage instead of proportion
live$Cov_percent=live$prop*100
min(live$Cov_percent)
max(live$Cov_percent)
median(live$Cov_percent)
# add variable that combines site and depth
live$site_depth=paste(live$SITE, live$DEPTH, sep="_")
############### Live coverage initial plot (my addition):
p_livecov <- ggplot(live, aes(x=DEPTH, y=prop,colour=DEPTH))+
geom_boxplot()+
geom_point(position=position_jitter(width=0.1))+
facet_grid(.~SITE) + # ggtitle("Live observations proportions in each site by depth") +
scale_y_continuous(labels = percent_format(accuracy = 1)) +  # Change y-axis labels to percentage
xlab("Depth (M)") + ylab("Precentage") +
#labs(colour = "Depth (M)") + # Add the legend title
theme_bw() +
theme(axis.title.x = element_text(colour="Black", size=14),
axis.title.y = element_text(colour="Black", size=14),
axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
#legend.title = element_text(size=14),
#legend.text = element_text(size=14),
legend.position = "none",
panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank(), # Remove minor grid lines
strip.text = element_text(size = 18) # Increase font size of facet labels
)
print(p_livecov)
####plot of IUI-N only for Amatzia
library(ggplot2)
library(scales)
# ---- Filter data to IUI-N only ----
live_IUIN <- subset(live, SITE == "IUI_N")
# ---- Plot: Live observations proportions in IUI-N by depth ----
p_livecov <- ggplot(live_IUIN, aes(x = DEPTH, y = prop, colour = DEPTH)) +
geom_boxplot() +
geom_point(position = position_jitter(width = 0.1)) +
# facet_grid(.~SITE)  # not needed because only one site is plotted
scale_y_continuous(labels = percent_format(accuracy = 1)) +
xlab("Depth (M)") + ylab("Precentage") +
theme_bw() +
theme(
axis.title.x = element_text(colour = "Black", size = 14),
axis.title.y = element_text(colour = "Black", size = 14),
axis.text.x  = element_text(size = 12),
axis.text.y  = element_text(size = 12),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
)
print(p_livecov)
# install.packages("car")
library(car)
prop_data<-live$prop # on prop data of all sites & depths (just a trial)
# For depth groups:
leveneTest(prop_data~DEPTH, data=live)
p_dens <-ggplot(data = live, aes(x = prop, fill = SITE)) +
geom_density(alpha = 0.7) + # Adjust alpha for transparency if needed
scale_fill_manual(values = c("JG" = "slategray", "IUI_S"="lightseagreen", "IUI_N" = "navyblue")) +
theme_bw() +
ylim(0,3.8) + # change limit of y axis
# ggtitle("Density plot of live proportion by site") +
xlab("Live proportion") + ylab("Density") +
theme(axis.title.x = element_text(colour="Black", size=14),
axis.title.y = element_text(colour="Black", size=14),
axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
legend.position = c(1,1), # legend position in the top right of plot area
legend.justification = c(1,1), # legend position inside the plot area
panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
)
print(p_dens)
p_dens_depth <- ggplot(data = live, aes(x = prop, fill = DEPTH)) +
geom_density(alpha = 0.7) + # Adjust alpha for transparency if needed
scale_fill_manual(values = c("45"="slategray", "35"="lightcoral", "25"="lightseagreen", "15"="maroon", "5"="midnightblue")) +
theme_bw() +
ylim(0,3.8) + # change limit of y axis
# ggtitle("Density plot of live proportion by depth") +
xlab("Live proportion") + ylab("Density") +
theme(axis.title.x = element_text(colour="Black", size=14),
axis.title.y = element_text(colour="Black", size=14),
axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
legend.title = element_text(size=14),
legend.text = element_text(size=14),
legend.position = c(1,1), # legend position in the top right of plot area
legend.justification = c(1,1), # legend position inside the plot area
panel.grid.major = element_blank(), # Remove major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
)
print(p_dens_depth)
### Aligned ranks anova:
model_live = art(prop ~ DEPTH,  data = live)
### Check the success of the procedure:
model_live
